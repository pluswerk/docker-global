version: '3.5'
services:
  global-nginx-proxy:
    image: jwilder/nginx-proxy
    restart: always
    ports:
      - "80:80"
    volumes:
      - /var/run/docker.sock:/tmp/docker.sock:ro
      - ./.docker/config/global-nginx-proxy/additional_nginx.conf:/etc/nginx/conf.d/additional_nginx.conf

  global-database:
    image: mysql:5.7
    restart: always
    ports: 
      - "3306:3306"
    volumes:
    - ./.docker/data/global-database:/var/lib/mysql
    environment:
      - MYSQL_ROOT_PASSWORD=root
    command: --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci --sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION

  global-mail:
    image: mailhog/mailhog
    restart: always
    ports:
      - "1025:1025"
    environment:
      - VIRTUAL_HOST=~^mail\..*\.iveins\.de
      - VIRTUAL_PORT=8025
      
  global-portainer:
    image: portainer/portainer
    restart: always
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./.docker/data/global-portainer:/data
    environment:
      - VIRTUAL_HOST=~^portainer\..*\.iveins\.de
    command: --no-auth

networks:
  default:
    name: global
